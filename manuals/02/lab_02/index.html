
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://nus-cs2100de.github.io/labs/manuals/02/lab_02/">
      
      
        <link rel="prev" href="../../01/lab_01/">
      
      
        <link rel="next" href="../../03/lab_03/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.11">
    
    
      
        <title>Lab 2 [Week 4] - CS2100DE Labs</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      

  
  
  
  
  <style>:root{--md-annotation-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M12.3%207.29c.2-.18.44-.29.7-.29.27%200%20.5.11.71.29.19.21.29.45.29.71%200%20.27-.1.5-.29.71-.21.19-.44.29-.71.29-.26%200-.5-.1-.7-.29-.19-.21-.3-.44-.3-.71%200-.26.11-.5.3-.71m-2.5%204.68s2.17-1.72%202.96-1.79c.74-.06.59.79.52%201.23l-.01.06c-.14.53-.31%201.17-.48%201.78-.38%201.39-.75%202.75-.66%203%20.1.34.72-.09%201.17-.39.06-.04.11-.08.16-.11%200%200%20.08-.08.16.03.02.03.04.06.06.08.09.14.14.19.02.27l-.04.02c-.22.15-1.16.81-1.54%201.05-.41.27-1.98%201.17-1.74-.58.21-1.23.49-2.29.71-3.12.41-1.5.59-2.18-.33-1.59-.37.22-.59.36-.72.45-.11.08-.12.08-.19-.05l-.03-.06-.05-.08c-.07-.1-.07-.11.03-.2M22%2012c0%205.5-4.5%2010-10%2010S2%2017.5%202%2012%206.5%202%2012%202s10%204.5%2010%2010m-2%200c0-4.42-3.58-8-8-8s-8%203.58-8%208%203.58%208%208%208%208-3.58%208-8%22/%3E%3C/svg%3E');}</style>


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Merriweather:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Merriweather";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="nus" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#lab-2-playing-with-the-7-segment-display" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="CS2100DE Labs" class="md-header__button md-logo" aria-label="CS2100DE Labs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CS2100DE Labs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Lab 2 [Week 4]
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="CS2100DE Labs" class="md-nav__button md-logo" aria-label="CS2100DE Labs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    CS2100DE Labs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    How to use this website
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prerequisites/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab Prerequisites
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../grading/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Grading
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Preparing for labs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Preparing for labs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/nexys4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting to know your Nexys 4
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://nus-cg3207.github.io/labs/Vivado_Installation_and_Getting_Started/vivado_install_guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation guide for Vivado (from CG3207)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Lab manuals
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Lab manuals
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../01/lab_01/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab 1 [Week 3]
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Lab 2 [Week 4]
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Lab 2 [Week 4]
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Introduction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#combinational-logic" class="md-nav__link">
    <span class="md-ellipsis">
      Combinational logic
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-the-seven-segment-display-works" class="md-nav__link">
    <span class="md-ellipsis">
      How the seven-segment display works
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#driving-the-seven-segment-display" class="md-nav__link">
    <span class="md-ellipsis">
      Driving the seven-segment display
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Driving the seven-segment display">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#design-specification" class="md-nav__link">
    <span class="md-ellipsis">
      Design specification
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriving-the-logic-needed" class="md-nav__link">
    <span class="md-ellipsis">
      Deriving the logic needed
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#writing-the-modules" class="md-nav__link">
    <span class="md-ellipsis">
      Writing the module(s)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-loops-in-systemverilog-simulation" class="md-nav__link">
    <span class="md-ellipsis">
      Using loops in SystemVerilog simulation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-fruits-of-our-labour" class="md-nav__link">
    <span class="md-ellipsis">
      The fruits of our labour
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#concluding-remarks" class="md-nav__link">
    <span class="md-ellipsis">
      Concluding remarks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#optional-practice-problem" class="md-nav__link">
    <span class="md-ellipsis">
      Optional practice problem
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../03/lab_03/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab 3 [Week 5]
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../04/lab_04/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab 4 [Week 6]
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../05/lab_05/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab 5 [Week 7]
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../06/lab_06/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab 6 [Week 8]
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../07/lab_07/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab 7 [Week 9]
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../08/lab_08/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab 8 [Week 11]
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Introduction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#combinational-logic" class="md-nav__link">
    <span class="md-ellipsis">
      Combinational logic
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-the-seven-segment-display-works" class="md-nav__link">
    <span class="md-ellipsis">
      How the seven-segment display works
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#driving-the-seven-segment-display" class="md-nav__link">
    <span class="md-ellipsis">
      Driving the seven-segment display
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Driving the seven-segment display">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#design-specification" class="md-nav__link">
    <span class="md-ellipsis">
      Design specification
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriving-the-logic-needed" class="md-nav__link">
    <span class="md-ellipsis">
      Deriving the logic needed
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#writing-the-modules" class="md-nav__link">
    <span class="md-ellipsis">
      Writing the module(s)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-loops-in-systemverilog-simulation" class="md-nav__link">
    <span class="md-ellipsis">
      Using loops in SystemVerilog simulation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-fruits-of-our-labour" class="md-nav__link">
    <span class="md-ellipsis">
      The fruits of our labour
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#concluding-remarks" class="md-nav__link">
    <span class="md-ellipsis">
      Concluding remarks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#optional-practice-problem" class="md-nav__link">
    <span class="md-ellipsis">
      Optional practice problem
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<div><h1 id="lab-2-playing-with-the-7-segment-display">Lab 2: Playing with the 7-segment display</h1>
<div class="admonition info">
<p class="admonition-title">Graded Lab Assignment</p>
<p>This lab includes a graded lab assignment, worth <strong>4 points</strong>. Refer to <a href="../../../grading/">the page on grading</a> for more information. </p>
<p>This assignment includes <strong>4 questions</strong>, clearly demarcated throughout the manual. </p>
</div>
<h2 id="introduction">Introduction</h2>
<p>Welcome back to the second lab assignment for CS2100DE! We hope you enjoyed last week's lab. This week, we will hold your hand significantly less than last week; but you can always refer back to <a href="../../01/lab_01/">Lab 1</a> for anything you need a refresher on. </p>
<p>In this lab, we will learn to write combinational logic in Vivado, and use it to drive our seven-segment displays on the board. The end result will take inputs from the switches on the board and display characters on the seven-segment displays accordingly. We will also learn some more interesting simulation techniques. </p>
<h3 id="combinational-logic">Combinational logic</h3>
<p>We learned about combinational logic in our lectures. Combinational logic is composed out of logic gates like NOT, AND, OR, XOR, and produces an output that is dependent purely on the input provided at that time. In other words, it has no memory elements, and cannot remember previous inputs or states. </p>
<p>Here's a refresher on the basic logic gates, and how to produce them in SystemVerilog:</p>
<ol>
<li>
<p><strong>NOT gate (inverter)</strong>: produces the opposite of the value going in.
    </p><div class="highlight"><pre><span></span><code><span class="k">assign</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">!</span><span class="n">in</span><span class="p">;</span><span class="w">   </span><span class="c1">// behavioral code</span>
<span class="k">not</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="p">);</span><span class="w">       </span><span class="c1">// structural code</span>
</code></pre></div>
</li>
<li>
<p><strong>Bitwise AND</strong>: takes two inputs, and produces a <code>1</code> if both inputs are <code>1</code>, and <code>0</code> otherwise. </p>
<div class="highlight"><pre><span></span><code><span class="k">assign</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">in_a</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">in_b</span><span class="p">;</span><span class="w">   </span><span class="c1">// behavioral code</span>
<span class="k">and</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="w"> </span><span class="n">in_a</span><span class="p">,</span><span class="w"> </span><span class="n">in_b</span><span class="p">);</span><span class="w">       </span><span class="c1">// structural code</span>
</code></pre></div>
</li>
<li>
<p><strong>Bitwise OR</strong>: takes two inputs, and produces a <code>1</code> if at least one input is <code>1</code>, and <code>0</code> otherwise. </p>
<div class="highlight"><pre><span></span><code><span class="k">assign</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">in_a</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">in_b</span><span class="p">;</span><span class="w">   </span><span class="c1">// behavioral code</span>
<span class="k">or</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="w"> </span><span class="n">in_a</span><span class="p">,</span><span class="w"> </span><span class="n">in_b</span><span class="p">);</span><span class="w">        </span><span class="c1">// structural code</span>
</code></pre></div>
</li>
<li>
<p><strong>Bitwise XOR</strong>: takes two inputs, and produces a <code>1</code> if exactly one input is <code>1</code>, and <code>0</code> otherwise. </p>
<div class="highlight"><pre><span></span><code><span class="k">assign</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">in_a</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">in_b</span><span class="p">;</span><span class="w">   </span><span class="c1">// behavioral code</span>
<span class="k">xor</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="w"> </span><span class="n">in_a</span><span class="p">,</span><span class="w"> </span><span class="n">in_b</span><span class="p">);</span><span class="w">       </span><span class="c1">// structural code</span>
</code></pre></div>
</li>
</ol>
<h3 id="how-the-seven-segment-display-works">How the seven-segment display works</h3>
<p>The <a href="https://digilent.com/reference/programmable-logic/nexys-4/reference-manual#seven-segment_display">Nexys 4 Reference Manual</a> does a very good job of explaining how the seven-segment displays are connected to the FPGA. </p>
<p>We all know and love seven-segment displays. They are used in all sorts of electronics - microwaves, lifts, car dashboards, CD players. The Nexys 4 has two 4-digit seven-segment displays. Each of the seven (eight, if you count the decimal point) segments of the display are a separate LED and turning different segments on and off will display different numbers (and letters). </p>
<p>LEDs have an anode (positive leg) and a cathode (negative leg). Current flows into the anode and out of the cathode. Similarly, the LEDs on the seven-segment display also each have an anode and a cathode. However, for each digit, we have one single anode shared by every segment. We still have a cathode for each segment, so we can control each segment individually.</p>
<p>Now, counterintuitively enough, while the anode is called... an anode, it actually needs to be driven low (i.e. set to <code>0</code>) to be enabled. This is what we call an "Active-low" enable. Thus, for a segment on the seven-segment displays to be lit, the anode corresponding to the digit, AND the cathode corresponding to the segment, must both be low, or <code>0</code>. </p>
<details class="note">
<summary>This makes no sense. Is it opposite day?</summary>
<p>The reason for this, as explained in the manual, is because the anodes each may need to carry a high current, so they are connected with transistors. A transistor will need 0 volts applied to its base to supply voltage to the anode, so that's why we must write <code>0</code> to the anode to enable it. </p>
</details>
<p>Understanding the technical details above by just reading a wall of text might take a bit of brain power, which you probably don't have at 9:30 AM on a Friday. So, let's look at some examples which will hopefully make things clear. The diagram below depicts one digit of a seven-segment display.</p>
<figure>
<p><img alt="" src="../360px-7_Segment_Display_with_Labeled_Segments.png"></p>
<figcaption>
<p>By <a href="//commons.wikimedia.org/w/index.php?title=User:Uln2003&amp;action=edit&amp;redlink=1" class="new" title="User:Uln2003 (page does not exist)">Uln2003</a> - <span class="int-own-work" lang="en">Own work</span>, <a href="http://creativecommons.org/publicdomain/zero/1.0/deed.en" title="Creative Commons Zero, Public Domain Dedication">CC0</a>, <a href="https://commons.wikimedia.org/w/index.php?curid=69807877">Link</a></p>
</figcaption>
</figure>
<p>We have labelled each segment of the digit A through G. Let us say we want to display the digit <code>7</code> on the rightmost digit on the display. We would need segments A, B, C to be lit. To do this, the anode for digit 0 (the rightmost one) needs to be set to <code>0</code>, and all other anodes need to be set to <code>1</code>. Then, cathodes A, B, and C need to be <code>0</code>, while the others need to be set to <code>1</code>. </p>
<p>In the constraints file that Digilent provides for the Nexys 4, the rightmost anode is numbered <code>0</code> and then the numbering continues to the left. Then, segment A maps to <code>0</code>, B to <code>1</code> and so on. So, <code>an[2]</code> maps to the third anode from the left. <code>seg[4]</code> maps to segment E. </p>
<p>Sadly, while each segment within a digit has an independent cathode, that cathode is shared by the same segment on every digit on the display. So the cathode for segment G on one digit is actually the same as the cathode for segment G on another digit. This means that two digits cannot display two different things at the same time. </p>
<details class="note">
<summary>Well, actually...</summary>
<p>The key phrase in the last sentence above is the caveat "at the same time". As the astute among you may have guessed (and the fastidious among you may have read in the Reference Manual), it is possible to flash one digit at a time, in sequence, and doing so fast enough can make each digit appear to show a different character to the human eye. However, doing this will require sequential logic, which you will have just started to cover in this week's lecture. We'll come back to this next week. </p>
</details>
<p>Let us look at some more examples:</p>
<ol>
<li>Anode 0 is set to <code>0</code>, all other anodes are set to <code>1</code>. Cathodes A, B, D, E and G are set to <code>0</code>, C, F and DP are set to <code>1</code>. </li>
</ol>
<p><img alt="" src="../example_1.png"></p>
<ol>
<li>Anodes 1, 4, and 6 are set to <code>0</code>, all other anodes are set to <code>1</code>. Cathodes A, D, E, and F are set to <code>0</code>, all other cathodes are set to <code>1</code>. </li>
</ol>
<p><img alt="" src="../example_2.png"></p>
<h2 id="driving-the-seven-segment-display">Driving the seven-segment display</h2>
<h3 id="design-specification">Design specification</h3>
<p>As mentioned in the <a href="#introduction">introduction</a>, we will use the switches to control what gets displayed on the seven-segment displays. We will use switches 0 through 6 in the following fashion:</p>
<ul>
<li>Switches 0 through 3 will be used to enter a 4-bit binary number. As you will remember from Lecture 1, a 4-bit binary number can be interpreted as a single hexadecimal digit. This hexadecimal digit is what we will display on the 7-segment display.</li>
<li>Switches 4 through 6 will be used to enter a 3-bit binary number. Thinking back again to Lecture 1, a 3-bit binary number can be interpreted as a decimal number between 0 and 7 (inclusive of both). In a happy coincidence, we have 8 digits on our seven-segment display, also numbered 0 through 7. The number entered with switches 4 through 6 will specify which digit of the seven-segment display(s) will be used to display the hex digit. </li>
</ul>
<div class="admonition example">
<p class="admonition-title">Example</p>
<ol>
<li>
<p>If <code>0001011</code> is entered with switches 6 through 0, the seven-segment display should display <code>B</code> on the rightmost digit. </p>
</li>
<li>
<p>If <code>1010010</code> is entered with the switches, the seven-segment display should display <code>2</code> on the third digit from the left. </p>
</li>
</ol>
</div>
<h3 id="deriving-the-logic-needed">Deriving the logic needed</h3>
<p>Before we get to writing RTL code, we should have some idea of what we want to do, in a more concrete manner than thoughts floating around in our heads. A good way to do this is to draw truth tables to specify exactly how our logic should behave. </p>
<p>Below is a picture illustrating what each character 0 through F should look like on the display:</p>
<figure>
<p><img alt="" src="../seven-seg-display-examples.png"></p>
<figcaption>
<p>The characters 0 through F being displayed</p>
</figcaption>
</figure>
<div class="admonition question">
<p class="admonition-title">Question 1: Nothing but the truth [1 point]</p>
<p>Write two truth tables for the seven-segment display decoder. The first should consider the anode output based on the input from switches 4 through 6. The second should consider the cathode output(s) based on the input from switches 0 through 3. </p>
<p>You may use a table in your word processor or draw one by hand and scan it. Handwriting must be very clear and legible. </p>
</div>
<p>Now that we have a concrete specification that we can work with, it will be much easier to write our RTL code. </p>
<h3 id="writing-the-modules">Writing the module(s)</h3>
<p>Create a new project in Vivado for your Nexys 4 board. Refer back to <a href="../../01/lab_01/">Lab 1</a> if you need to. In the project, create a <code>Top.sv</code> file (design source), a <code>SevenSegDecoder_sim.sv</code> file (simulation source), and import the <code>Nexys-4-Master.xdc</code> or <code>Nexys-4-DDR-Master.xdc</code> file (constraints).  </p>
<p>Download the <code>SevenSegDecoder.sv</code> file from the <a href="https://github.com/NUS-CS2100DE/labs/">GitHub repository</a>. Import it into your project. It is already filled with the inputs and outputs we expect you to use for this module. In summary, it takes the switches as input, and produces an output to the seven-segment displays. </p>
<p>This module should implement the logic derived in <a href="#deriving-the-logic-needed">the section above</a>. So, we now fill out the module with the SystemVerilog code needed to implement the logic. </p>
<div class="admonition question">
<p class="admonition-title">Question 2: Cracking the Code [1 point]</p>
<p>Write the logic for the seven-segment display decoder. The logic for the anodes must be written with <strong>structural</strong> SystemVerilog, while the logic for the cathodes can be written with behavioral SystemVerilog. 
Paste your code for this module into your report. You may exclude the comment header that Vivado automatically generates. </p>
</div>
<p>Cool! We now have our decoder written. No prizes for guessing what the next step is: it's simulation time. </p>
<h2 id="using-loops-in-systemverilog-simulation">Using loops in SystemVerilog simulation</h2>
<p>Last week, we simulated the adder with a few (carefully selected) test cases, which just so happened to find the (carefully placed) bug in the HDL code. This week, we're not so lucky - who knows what bugs we've introduced, and where! It's probably a good idea to test all the possibilities, rather than end up like <a href="https://en.wikipedia.org/wiki/Pentium_FDIV_bug">that one Intel Pentium</a>. </p>
<p>While it is impossible (okay, <em>impractical</em>) to test every possible case for floating point operations, it's certainly very possible to simulate 16 cases for switches 0 through 3, and 8 cases for switches 4 through 6. Still, writing 24 test cases by hand doesn't sound fun. Thankfully, we don't have to - this is where loops in SystemVerilog come in. </p>
<p>You should be familiar with loops in at least one programming language - C/C++ from Arduino, Python from CS1010E, or another language you picked up yourself (Java? Rust? COBOL?). SystemVerilog has loops too, and they're a very useful tool in simulations, where you might want to repeatedly input different test cases. </p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You can, in fact, use loops in SystemVerilog RTL code. However, they are <strong>NOT</strong> used to repeat computations or actions - instead, they are used strictly to avoid writing repeated RTL code. Do <strong>NOT</strong> confuse yourself with this, and do <strong>NOT</strong> use loops in RTL code if you do not understand what they do. </p>
<p>We have included an example of a loop in RTL code in <code>SevenSegDecoder.sv</code> for you to understand how loops should be used: </p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">genvar</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
<span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">    </span><span class="k">assign</span><span class="w"> </span><span class="n">an</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">sw</span><span class="p">[</span><span class="mi">6</span><span class="o">:</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="k">end</span>
</code></pre></div></td></tr></table></div>
</div>
<p>Let's look back at <code>Adder_sim.sv</code> from last week, and consider how we could use a loop to go through many possible inputs. </p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked id="__tabbed_1_1" name="__tabbed_1" type="radio"><input id="__tabbed_1_2" name="__tabbed_1" type="radio"><div class="tabbed-labels"><label for="__tabbed_1_1">Without using loops</label><label for="__tabbed_1_2">Using loops</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">initial</span><span class="w"> </span><span class="k">begin</span>
<span class="w">    </span><span class="n">in_a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mb">8'b0</span><span class="p">;</span>
<span class="w">    </span><span class="n">in_b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mb">8'b0</span><span class="p">;</span>
<span class="w">    </span><span class="p">#</span><span class="mi">10</span><span class="p">;</span>
<span class="w">    </span><span class="n">in_a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mb">8'b1010</span><span class="p">;</span>
<span class="w">    </span><span class="n">in_b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mb">8'b1010</span><span class="p">;</span>
<span class="w">    </span><span class="p">#</span><span class="mi">10</span><span class="p">;</span>
<span class="w">    </span><span class="n">in_a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mb">8'b11111111</span><span class="p">;</span>
<span class="w">    </span><span class="n">in_b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mb">8'b11111111</span><span class="p">;</span>
<span class="w">    </span><span class="p">#</span><span class="mi">10</span><span class="p">;</span>
<span class="k">end</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">initial</span><span class="w"> </span><span class="k">begin</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">256</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">        </span><span class="n">in_a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">256</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">            </span><span class="n">in_b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="p">;</span>
<span class="w">            </span><span class="p">#</span><span class="mi">10</span><span class="p">;</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
</div>
</div>
</div>
<p>Now, let's try and practice making loops by ourselves, by writing a loop in our simulation that will test every possible combination of switches. </p>
<p>For today, it will suffice to test the digit input (i.e. switches 0 through 3, determining what digit is to be displayed) separately from the selection input (i.e. switches 4 through 6, determining which digit of the seven-segment displays is used to display the digit). </p>
<div class="admonition question">
<p class="admonition-title">Question 3: Froot Loops [1 points]</p>
<p>Show your HDL simulation code, which should loop through every possible input from the switches. </p>
</div>
<p>Needless to say, we should run the simulation and make sure that there are no bugs in the code we have written. If there are, we should fix them, and run the simulation again - and repeat the problem until our code works flawlessly. </p>
<h2 id="the-fruits-of-our-labour">The fruits of our labour</h2>
<p>Finally, it is time for us to see the results of our hard work. This time, no more training wheels - only the basic steps are given here!</p>
<ol>
<li>
<p>First, we need to put an instance of our <code>SevenSegDecoder</code> module inside our <code>Top</code> module, and make the appropriate connections. </p>
</li>
<li>
<p>Next, we need to set up the constraints file. Which peripherals are we using? How should we modify the constraints file to use these?</p>
</li>
<li>
<p>Finally, run synthesis, implementation and generate the bitstream. </p>
</li>
</ol>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want to save a little bit of time and brain power, you can just click "Generate Bitstream", and if you haven't already run synthesis and implementation, Vivado will prompt you for permission to automatically do so. </p>
<p><img alt="" src="../vivado-outdated-prompt.png"></p>
</div>
<div class="admonition question">
<p class="admonition-title">Question 4: Just like the simulations [1 point]</p>
<p>Tell your nearest GA you are ready to test your design. They will give you five test cases to try. Try all of them on your board, and show one picture for each test case in your report. </p>
</div>
<h2 id="concluding-remarks">Concluding remarks</h2>
<p>Well done! We've finished the second lab assignment. Remember to follow the instructions on the <a href="../../../grading/#lab-assignments">Grading Page</a>. </p>
<div class="admonition success">
<p class="admonition-title">What we should know</p>
<ul>
<li>How the seven-segment displays on the Nexys 4 board work. </li>
<li>How to write truth tables for logic. </li>
<li>How to write RTL code in SystemVerilog from scratch.</li>
<li>How to use loops in HDL simulation code. </li>
</ul>
</div>
<h2 id="optional-practice-problem">Optional practice problem</h2>
<p>Using the Adder module from last week, modify the system to add up the numbers input by switches 0 through 3, and switches 8 through 11. Display the least significant hex digit on the seven-segment display, and the most significant hex digit on the LEDs as a binary number. You should still be able to use switches 4 through 6 to select the digit of the seven-segment displays used. </p></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      <p xmlns:cc="http://creativecommons.org/ns#" xmlns:dct="http://purl.org/dc/terms/"><a property="dct:title" rel="cc:attributionURL" href="https://nus-cs2100de.github.io/labs">NUS CS2100DE Labs</a> by <a rel="cc:attributionURL dct:creator" property="cc:attributionName" href="https://github.com/nus-cs2100de">NUS CS2100DE Team</a> is licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/?ref=chooser-v1" target="_blank" rel="license noopener noreferrer" style="display:inline-block;">CC BY-NC-SA 4.0<img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1" alt=""><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1" alt=""><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/nc.svg?ref=chooser-v1" alt=""><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/sa.svg?ref=chooser-v1" alt=""></a></p>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/nus-cs2100de" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
    <a href="mailto:neil@nus.edu.sg" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4l217.6 163.2c11.4 8.5 27 8.5 38.4 0l217.6-163.2c12.1-9.1 19.2-23.3 19.2-38.4 0-26.5-21.5-48-48-48zM0 176v208c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64V176L294.4 339.2a63.9 63.9 0 0 1-76.8 0z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>